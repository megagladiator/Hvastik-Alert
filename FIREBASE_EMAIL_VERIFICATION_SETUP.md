# Настройка подтверждения Email в Firebase

## Текущий статус
✅ **Email/Password** - включен  
✅ **Email link (passwordless sign-in)** - включен  
❌ **Обязательное подтверждение email** - не настроено

## Проблема
Пользователи регистрируются без подтверждения email, поэтому в админ-панели показывается "Email подтвержден: Нет".

## Решение

### 1. Настройка шаблонов писем

1. Перейдите в **Firebase Console** → **Authentication** → **Templates**
2. Выберите **"Email address verification"**
3. Настройте шаблон письма:
   - **Subject**: "Подтвердите ваш email для Hvastik-Alert"
   - **Body**: Добавьте ссылку подтверждения и информацию о приложении

### 2. Настройка домена для ссылок

1. Перейдите в **Authentication** → **Settings** → **Authorized domains**
2. Убедитесь, что добавлены:
   - `localhost` (для разработки)
   - `your-domain.com` (для продакшена)

### 3. Настройка действия после подтверждения

1. В **Templates** → **Email address verification**
2. Установите **Action URL**: `https://your-domain.com/auth/verify-email`
3. Или для разработки: `http://localhost:3000/auth/verify-email`

### 4. Включение обязательного подтверждения (опционально)

Если хотите, чтобы новые пользователи обязательно подтверждали email:

1. Перейдите в **Authentication** → **Settings** → **User actions**
2. Включите **"Require email verification"**

## Альтернативное решение

### Отправка подтверждения через админ-панель

1. В админ-панели нажмите на пользователя
2. Выберите **"Отправить подтверждение email"**
3. Ссылка будет сгенерирована и показана в консоли
4. Скопируйте ссылку и отправьте пользователю

### Программная отправка

```javascript
// Пример отправки письма подтверждения
const actionCodeSettings = {
  url: 'https://your-domain.com/auth/verify-email',
  handleCodeInApp: true,
}

const link = await adminAuth.generateEmailVerificationLink(email, actionCodeSettings)
// Отправить ссылку пользователю через email сервис
```

## Проверка результата

После настройки:
1. Новые пользователи получат письмо с подтверждением
2. Существующие пользователи могут получить подтверждение через админ-панель
3. В админ-панели будет показываться "Email подтвержден: Да"

## Важно

- **Не включайте** "Require email verification" для существующих пользователей без предупреждения
- **Настройте** правильные домены в Authorized domains
- **Протестируйте** отправку писем в тестовом режиме
