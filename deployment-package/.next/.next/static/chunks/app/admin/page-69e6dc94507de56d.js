(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4379:function(e,s,a){Promise.resolve().then(a.bind(a,180))},180:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return eI}});var t,r,l,n,i=a(7437),c=a(2265),d=a(2869),o=a(6070),m=a(9376),x=a(8190),u=a(5186),h=a(6815),f=a(1817),g=a(3113),j=a(1671),p=a(7689),N=a(2141);function b(){let[e,s]=(0,c.useState)(null),[a,t]=(0,c.useState)(null),[r,l]=(0,c.useState)(!1),[n,m]=(0,c.useState)(!1),[x,b]=(0,c.useState)([50]),[v,w]=(0,c.useState)(null),[y,k]=(0,c.useState)(!0),C="00000000-0000-0000-0000-000000000001";(0,c.useEffect)(()=>{_()},[]);let _=async()=>{k(!0);try{if(!N.O){console.warn("Supabase not configured, using default settings"),b([50]),w("/placeholder.svg?height=1080&width=1920");return}let{data:e,error:s}=await N.O.from("app_settings").select("*").eq("id",C).single();s?(console.error("Error fetching app settings:",s),b([50]),w("/placeholder.svg?height=1080&width=1920")):e&&(console.log("Fetched settings from database:",e),b([e.background_darkening_percentage]),e.background_image_url?(console.log("Setting current image URL from database:",e.background_image_url),w(e.background_image_url)):(console.log("No background image URL in database, using fallback"),w("/view-cats-dogs-showing-friendship (1) — копия.jpg")))}finally{k(!1)}},S=async()=>{if(!e){alert("Пожалуйста, выберите изображение для загрузки.");return}l(!0),m(!1);try{let s="background-".concat(Date.now(),".").concat(e.name.split(".").pop()),a="/".concat(s),{error:t}=await N.O.from("app_settings").update({background_image_url:a,updated_at:new Date().toISOString()}).eq("id",C);t?(console.error("Error updating app settings in DB:",t),alert("Ошибка сохранения URL изображения в базе данных.")):(w(a),alert("Изображение успешно установлено как фон! (Для полной функциональности нужно настроить Supabase Storage)"),m(!0))}catch(e){console.error("Unexpected error during upload:",e),alert("Произошла непредвиденная ошибка.")}finally{l(!1)}},Z=e=>{w(e),t(e)},z=async()=>{try{if(!N.O){alert("Supabase не настроен. Настройки не могут быть сохранены.");return}let e=a||v;if(!e){alert("Выберите изображение для сохранения.");return}console.log("Saving settings to database:",{imageUrl:e,darkeningPercentage:x[0],settingsRowId:C});let s={background_image_url:e,background_darkening_percentage:x[0],updated_at:new Date().toISOString()};console.log("Update data:",s);let{error:r}=await N.O.from("app_settings").update(s).eq("id",C);r?(console.error("Error saving settings:",r),alert("Ошибка сохранения настроек в базе данных.")):(w(e),t(null),console.log("Settings saved successfully"),alert("Настройки успешно сохранены! Теперь нажмите 'Обновить настройки' чтобы применить изменения на главной странице."))}catch(e){console.error("Unexpected error during save:",e),alert("Произошла непредвиденная ошибка при сохранении.")}},E=async()=>{try{console.log("Starting settings refresh..."),console.log("Current image URL before refresh:",v),await _(),console.log("Current image URL after fetchSettings:",v),window.dispatchEvent(new CustomEvent("settingsUpdated")),console.log("Settings update event dispatched"),(await fetch("/api/refresh-settings",{method:"POST",headers:{"Content-Type":"application/json"}})).ok?alert("Настройки успешно обновлены! Главная страница автоматически обновится."):alert("Настройки обновлены локально. Если главная страница не обновилась, перезагрузите её вручную.")}catch(e){console.error("Error refreshing settings:",e),window.dispatchEvent(new CustomEvent("settingsUpdated")),alert("Настройки обновлены локально. Если главная страница не обновилась, перезагрузите её вручную.")}},R=e=>{b(e)};return y?(0,i.jsx)(o.Zb,{className:"w-full max-w-md mx-auto",children:(0,i.jsxs)(o.aY,{className:"flex flex-col items-center justify-center p-8",children:[(0,i.jsx)(f.Z,{className:"h-8 w-8 animate-spin text-orange-500 mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Загрузка настроек..."})]})}):(0,i.jsxs)(o.Zb,{className:"w-full max-w-md mx-auto",children:[(0,i.jsx)(o.Ol,{children:(0,i.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,i.jsx)(g.Z,{className:"h-5 w-5 text-orange-500"}),"Настройки фонового изображения"]})}),(0,i.jsxs)(o.aY,{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(h._,{children:"Текущее фоновое изображение"}),(0,i.jsx)("div",{className:"relative w-full h-48 border border-gray-200 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center",children:v?(0,i.jsx)("img",{src:v||"/placeholder.svg",alt:"Текущий фон",className:"object-cover w-full h-full"}):(0,i.jsx)("span",{className:"text-gray-500 text-sm",children:"Изображение не установлено"})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(h._,{children:"Быстрый выбор изображения"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)(d.z,{variant:"outline",onClick:()=>Z("/kitten-dog-friendship.jpg"),className:"text-xs",children:"Кот и собака"}),(0,i.jsx)(d.z,{variant:"outline",onClick:()=>Z("/view-cats-dogs-showing-friendship (1) — копия.jpg"),className:"text-xs",children:"Дружба животных"}),(0,i.jsx)(d.z,{variant:"outline",onClick:()=>Z("/adorable-looking-kitten-with-dog.jpg"),className:"text-xs",children:"Милые питомцы"}),(0,i.jsx)(d.z,{variant:"outline",onClick:()=>Z("/view-cats-dogs-being-friends.jpg"),className:"text-xs",children:"Друзья"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(h._,{htmlFor:"background-image-upload",children:"Загрузить новое изображение"}),(0,i.jsx)(u.I,{id:"background-image-upload",type:"file",accept:"image/*",onChange:e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];r?(s(r),t(URL.createObjectURL(r)),m(!1)):(s(null),t(null))},className:"file:text-orange-500 file:font-semibold"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Поддерживаются форматы: JPG, PNG, WebP. Макс. размер 5МБ."})]}),a&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(h._,{children:"Предварительный просмотр нового изображения"}),(0,i.jsx)("div",{className:"relative w-full h-48 border border-gray-200 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center",children:(0,i.jsx)("img",{src:a||"/placeholder.svg",alt:"Предварительный просмотр",className:"object-cover w-full h-full"})})]}),(0,i.jsx)(d.z,{onClick:S,disabled:!e||r,className:"w-full bg-orange-500 hover:bg-orange-600",children:r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{className:"h-4 w-4 mr-2 animate-spin"})," Загрузка..."]}):n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{className:"h-4 w-4 mr-2"})," Успешно загружено!"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{className:"h-4 w-4 mr-2"})," Загрузить и установить"]})}),(0,i.jsxs)(d.z,{onClick:z,className:"w-full bg-green-500 hover:bg-green-600 text-white",children:[(0,i.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Сохранить настройки"]}),(0,i.jsxs)(d.z,{onClick:E,variant:"outline",className:"w-full border-orange-500 text-orange-500 hover:bg-orange-50",children:[(0,i.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Обновить настройки на главной странице"]}),(0,i.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,i.jsxs)(h._,{htmlFor:"darkening-input",children:["Процент затемнения фона: ",x[0],"%"]}),(0,i.jsx)(u.I,{id:"darkening-input",type:"range",min:0,max:100,step:1,value:x[0],onChange:e=>R([parseInt(e.target.value)]),className:"w-full"}),(0,i.jsx)("p",{className:"text-sm text-gray-500",children:"Регулирует прозрачность черного слоя поверх фонового изображения. 0% - без затемнения, 100% - полностью черный."})]})]})]})}var v=a(5805),w=a(9663),y=a(3745),k=a(7806),C=a(7168),_=a(5974),S=a(2369),Z=a(1533),z=a(8906),E=a(4286),R=a(5468),O=a(9345),T=a(8930),I=a(1047),A=a(7881),D=a(407),P=a(401),Y=a(519),U=a(4508);let L=A.fC,F=A.xz;A.ZA,A.Uv,A.Tr,A.Ee,c.forwardRef((e,s)=>{let{className:a,inset:t,children:r,...l}=e;return(0,i.jsxs)(A.fF,{ref:s,className:(0,U.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",a),...l,children:[r,(0,i.jsx)(D.Z,{className:"ml-auto"})]})}).displayName=A.fF.displayName,c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(A.tu,{ref:s,className:(0,U.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...t})}).displayName=A.tu.displayName;let V=c.forwardRef((e,s)=>{let{className:a,sideOffset:t=4,...r}=e;return(0,i.jsx)(A.Uv,{children:(0,i.jsx)(A.VY,{ref:s,sideOffset:t,className:(0,U.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})})});V.displayName=A.VY.displayName;let B=c.forwardRef((e,s)=>{let{className:a,inset:t,...r}=e;return(0,i.jsx)(A.ck,{ref:s,className:(0,U.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",a),...r})});B.displayName=A.ck.displayName,c.forwardRef((e,s)=>{let{className:a,children:t,checked:r,...l}=e;return(0,i.jsxs)(A.oC,{ref:s,className:(0,U.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...l,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(A.wU,{children:(0,i.jsx)(P.Z,{className:"h-4 w-4"})})}),t]})}).displayName=A.oC.displayName,c.forwardRef((e,s)=>{let{className:a,children:t,...r}=e;return(0,i.jsxs)(A.Rk,{ref:s,className:(0,U.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(A.wU,{children:(0,i.jsx)(Y.Z,{className:"h-2 w-2 fill-current"})})}),t]})}).displayName=A.Rk.displayName,c.forwardRef((e,s)=>{let{className:a,inset:t,...r}=e;return(0,i.jsx)(A.__,{ref:s,className:(0,U.cn)("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",a),...r})}).displayName=A.__.displayName,c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(A.Z0,{ref:s,className:(0,U.cn)("-mx-1 my-1 h-px bg-muted",a),...t})}).displayName=A.Z0.displayName;var M=a(8078);let J=M.fC;M.xz;let G=M.h_,q=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(M.aV,{className:(0,U.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:s})});q.displayName=M.aV.displayName;let Q=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsxs)(G,{children:[(0,i.jsx)(q,{}),(0,i.jsx)(M.VY,{ref:s,className:(0,U.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]})});Q.displayName=M.VY.displayName;let W=e=>{let{className:s,...a}=e;return(0,i.jsx)("div",{className:(0,U.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...a})};W.displayName="AlertDialogHeader";let X=e=>{let{className:s,...a}=e;return(0,i.jsx)("div",{className:(0,U.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};X.displayName="AlertDialogFooter";let H=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(M.Dx,{ref:s,className:(0,U.cn)("text-lg font-semibold",a),...t})});H.displayName=M.Dx.displayName;let $=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(M.dk,{ref:s,className:(0,U.cn)("text-sm text-muted-foreground",a),...t})});$.displayName=M.dk.displayName;let K=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(M.aU,{ref:s,className:(0,U.cn)((0,d.d)(),a),...t})});K.displayName=M.aU.displayName;let ee=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)(M.$j,{ref:s,className:(0,U.cn)((0,d.d)({variant:"outline"}),"mt-2 sm:mt-0",a),...t})});function es(e){let{user:s,onRoleChange:a,onStatusChange:t,onDelete:r}=e,[l,n]=(0,c.useState)(!1),[m,x]=(0,c.useState)(!1),u=e=>{if(!e)return"Не указано";try{let s="string"==typeof e?new Date(e):e;if(isNaN(s.getTime()))return"Неверная дата";return s.toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(e){return"Ошибка даты"}},h=async e=>{if(e!==s.role){x(!0);try{await a(s.id,e)}finally{x(!1)}}},f=async e=>{if(e!==s.status){x(!0);try{await t(s.id,e)}finally{x(!1)}}},g=async()=>{x(!0);try{await r(s.id),n(!1)}finally{x(!1)}},p=async e=>{x(!0);try{let s=await fetch("/api/users/send-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to send verification")}let a=await s.json();console.log("Verification link:",a.link),alert("Ссылка для подтверждения email отправлена на ".concat(e))}catch(e){console.error("Ошибка отправки подтверждения:",e),alert("Ошибка: ".concat(e.message))}finally{x(!1)}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,i.jsx)(o.Ol,{className:"pb-3",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"p-2 bg-orange-100 rounded-full",children:(0,i.jsx)(S.Z,{className:"h-5 w-5 text-orange-600"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(o.ll,{className:"text-lg",children:s.email}),(0,i.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(e=>{switch(e){case"admin":return(0,i.jsx)(_.C,{className:"bg-purple-100 text-purple-800",children:"Администратор"});case"user":return(0,i.jsx)(_.C,{className:"bg-blue-100 text-blue-800",children:"Пользователь"});default:return(0,i.jsx)(_.C,{variant:"secondary",children:"Неизвестно"})}})(s.role),(e=>{switch(e){case"active":return(0,i.jsx)(_.C,{className:"bg-green-100 text-green-800",children:"Активный"});case"banned":return(0,i.jsx)(_.C,{className:"bg-red-100 text-red-800",children:"Заблокирован"});case"inactive":return(0,i.jsx)(_.C,{className:"bg-yellow-100 text-yellow-800",children:"Неактивный"});default:return(0,i.jsx)(_.C,{variant:"secondary",children:"Неизвестно"})}})(s.status)]})]})]}),(0,i.jsxs)(L,{children:[(0,i.jsx)(F,{asChild:!0,children:(0,i.jsx)(d.z,{variant:"ghost",size:"sm",disabled:m,children:(0,i.jsx)(Z.Z,{className:"h-4 w-4"})})}),(0,i.jsxs)(V,{align:"end",children:[(0,i.jsx)(B,{onClick:()=>h("admin"===s.role?"user":"admin"),disabled:m,children:"admin"===s.role?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(z.Z,{className:"h-4 w-4 mr-2"}),"Сделать пользователем"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(E.Z,{className:"h-4 w-4 mr-2"}),"Сделать администратором"]})}),(0,i.jsx)(B,{onClick:()=>f("active"===s.status?"banned":"active"),disabled:m,children:"active"===s.status?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.Z,{className:"h-4 w-4 mr-2"}),"Заблокировать"]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Разблокировать"]})}),!s.emailVerified&&(0,i.jsxs)(B,{onClick:()=>p(s.email),disabled:m,children:[(0,i.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Отправить подтверждение email"]}),(0,i.jsxs)(B,{onClick:()=>n(!0),className:"text-red-600",disabled:m,children:[(0,i.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Удалить"]})]})]})]})}),(0,i.jsx)(o.aY,{className:"pt-0",children:(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(O.Z,{className:"h-4 w-4 text-gray-400"}),(0,i.jsx)("span",{className:"text-gray-600",children:"Email подтвержден:"}),(0,i.jsx)("span",{className:s.emailVerified?"text-green-600":"text-red-600",children:s.emailVerified?"Да":"Нет"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(I.Z,{className:"h-4 w-4 text-gray-400"}),(0,i.jsx)("span",{className:"text-gray-600",children:"Регистрация:"}),(0,i.jsx)("span",{children:u(s.createdAt)})]}),s.lastLoginAt&&(0,i.jsxs)("div",{className:"flex items-center gap-2 col-span-2",children:[(0,i.jsx)(I.Z,{className:"h-4 w-4 text-gray-400"}),(0,i.jsx)("span",{className:"text-gray-600",children:"Последний вход:"}),(0,i.jsx)("span",{children:u(s.lastLoginAt)})]})]})})]}),(0,i.jsx)(J,{open:l,onOpenChange:n,children:(0,i.jsxs)(Q,{children:[(0,i.jsxs)(W,{children:[(0,i.jsx)(H,{children:"Удалить пользователя?"}),(0,i.jsxs)($,{children:["Вы уверены, что хотите удалить пользователя ",(0,i.jsx)("strong",{children:s.email}),"? Это действие нельзя отменить. Все данные пользователя будут удалены навсегда."]})]}),(0,i.jsxs)(X,{children:[(0,i.jsx)(ee,{children:"Отмена"}),(0,i.jsx)(K,{onClick:g,className:"bg-red-600 hover:bg-red-700",disabled:m,children:m?"Удаление...":"Удалить"})]})]})})]})}ee.displayName=M.$j.displayName;var ea=a(3647),et=a(740),er=a(3247),el=a(2489);function en(e){let{filters:s,onFiltersChange:a,onSearch:t,onReset:r}=e,[m,x]=(0,c.useState)(s),h=(e,s)=>{let t={...m,[e]:s};x(t),a(t)};return(0,i.jsxs)(o.Zb,{className:"mb-6",children:[(0,i.jsx)(o.Ol,{children:(0,i.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,i.jsx)(et.Z,{className:"h-5 w-5"}),"Фильтры и поиск"]})}),(0,i.jsxs)(o.aY,{children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,i.jsxs)("div",{className:"md:col-span-2",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Поиск по email"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(er.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,i.jsx)(u.I,{placeholder:"Введите email пользователя...",value:m.search,onChange:e=>h("search",e.target.value),className:"pl-10"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Роль"}),(0,i.jsxs)(ea.Ph,{value:m.role,onValueChange:e=>h("role",e),children:[(0,i.jsx)(ea.i4,{children:(0,i.jsx)(ea.ki,{placeholder:"Выберите роль"})}),(0,i.jsxs)(ea.Bw,{children:[(0,i.jsx)(ea.Ql,{value:"all",children:"Все роли"}),(0,i.jsx)(ea.Ql,{value:l.USER,children:"Пользователь"}),(0,i.jsx)(ea.Ql,{value:l.ADMIN,children:"Администратор"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Статус"}),(0,i.jsxs)(ea.Ph,{value:m.status,onValueChange:e=>h("status",e),children:[(0,i.jsx)(ea.i4,{children:(0,i.jsx)(ea.ki,{placeholder:"Выберите статус"})}),(0,i.jsxs)(ea.Bw,{children:[(0,i.jsx)(ea.Ql,{value:"all",children:"Все статусы"}),(0,i.jsx)(ea.Ql,{value:n.ACTIVE,children:"Активные"}),(0,i.jsx)(ea.Ql,{value:n.BLOCKED,children:"Заблокированные"}),(0,i.jsx)(ea.Ql,{value:n.PENDING,children:"Ожидающие"})]})]})]})]}),(0,i.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,i.jsxs)(d.z,{onClick:()=>{t()},className:"bg-orange-500 hover:bg-orange-600",children:[(0,i.jsx)(er.Z,{className:"h-4 w-4 mr-2"}),"Поиск"]}),(0,i.jsxs)(d.z,{variant:"outline",onClick:()=>{let e={search:"",role:"all",status:"all"};x(e),a(e),r()},children:[(0,i.jsx)(el.Z,{className:"h-4 w-4 mr-2"}),"Сбросить"]})]})]})]})}(t=l||(l={})).USER="user",t.ADMIN="admin",(r=n||(n={})).ACTIVE="active",r.BLOCKED="blocked",r.PENDING="pending";let ei=0,ec=new Map,ed=e=>{if(ec.has(e))return;let s=setTimeout(()=>{ec.delete(e),eu({type:"REMOVE_TOAST",toastId:e})},1e6);ec.set(e,s)},eo=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=s;return a?ed(a):e.toasts.forEach(e=>{ed(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},em=[],ex={toasts:[]};function eu(e){ex=eo(ex,e),em.forEach(e=>{e(ex)})}function eh(e){let{...s}=e,a=(ei=(ei+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>eu({type:"DISMISS_TOAST",toastId:a});return eu({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:e=>{e||t()}}}),{id:a,dismiss:t,update:e=>eu({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function ef(){let[e,s]=(0,c.useState)({email:"",role:"all",status:"all"}),{users:a,loading:t,error:r,refetch:l,createUser:n,updateUser:m,deleteUser:u}=function(e){let{user:s,loading:a,isAuthenticated:t}=(0,x.B)(),[r,l]=(0,c.useState)([]),[n,i]=(0,c.useState)(!0),[d,o]=(0,c.useState)(null);(0,c.useEffect)(()=>{if(!a){if(!t||!s){l([]),i(!1);return}m()}},[e,s,a,t]);let m=async()=>{try{i(!0),o(null);let{data:{session:s}}=await N.O.auth.getSession();if(console.log("Session in useUsers:",s),!(null==s?void 0:s.access_token))throw console.error("No access token available in useUsers"),Error("No access token available");let a=new URLSearchParams;(null==e?void 0:e.email)&&a.append("email",e.email),(null==e?void 0:e.role)&&a.append("role",e.role),(null==e?void 0:e.status)&&a.append("status",e.status),console.log("Making API request to:","/api/users?".concat(a.toString())),console.log("With token:",s.access_token.substring(0,20)+"...");let t=await fetch("/api/users?".concat(a.toString()),{headers:{Authorization:"Bearer ".concat(s.access_token)}});if(console.log("API response status:",t.status),!t.ok){let e=await t.text();throw console.error("API error response:",e),Error("Failed to fetch users")}let r=await t.json();console.log("API response data:",r),l(r.users)}catch(e){o(e.message),console.error("Error fetching users:",e)}finally{i(!1)}},u=async e=>{try{let{data:{session:s}}=await N.O.auth.getSession();if(!(null==s?void 0:s.access_token))throw Error("No access token available");let a=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.access_token)},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to create user")}let t=await a.json();return await m(),t.user}catch(e){throw o(e.message),e}},h=async(e,s)=>{try{let{data:{session:a}}=await N.O.auth.getSession();if(!(null==a?void 0:a.access_token))throw Error("No access token available");let t=await fetch("/api/users",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a.access_token)},body:JSON.stringify({id:e,...s})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update user")}let r=await t.json();return await m(),r.user}catch(e){throw o(e.message),e}},f=async e=>{try{let{data:{session:s}}=await N.O.auth.getSession();if(!(null==s?void 0:s.access_token))throw Error("No access token available");let a=await fetch("/api/users?id=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s.access_token)}});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to delete user")}await m()}catch(e){throw o(e.message),e}};return{users:r,loading:n,error:d,refetch:m,createUser:u,updateUser:h,deleteUser:f}}(e),{toast:h}=function(){let[e,s]=c.useState(ex);return c.useEffect(()=>(em.push(s),()=>{let e=em.indexOf(s);e>-1&&em.splice(e,1)}),[e]),{...e,toast:eh,dismiss:e=>eu({type:"DISMISS_TOAST",toastId:e})}}(),g={total_users:a.length,active_users:a.filter(e=>"active"===e.status).length,blocked_users:a.filter(e=>"banned"===e.status).length,new_users_this_month:a.filter(e=>{let s=new Date;return s.setMonth(s.getMonth()-1),new Date(e.createdAt)>s}).length},j=async(e,s)=>{try{await m(e,{role:s}),h({title:"Успешно",description:"Роль пользователя изменена"})}catch(e){console.error("Ошибка изменения роли:",e),h({title:"Ошибка",description:"Не удалось изменить роль пользователя",variant:"destructive"})}},p=async(e,s)=>{try{await m(e,{status:s}),h({title:"Успешно",description:"Пользователь ".concat("banned"===s?"заблокирован":"разблокирован")})}catch(e){console.error("Ошибка изменения статуса:",e),h({title:"Ошибка",description:"Не удалось изменить статус пользователя",variant:"destructive"})}},b=async e=>{try{await u(e),h({title:"Успешно",description:"Пользователь удален"})}catch(e){console.error("Ошибка удаления пользователя:",e),h({title:"Ошибка",description:"Не удалось удалить пользователя",variant:"destructive"})}};return(0,i.jsxs)("div",{className:"space-y-6",children:[g&&(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Всего пользователей"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.total_users})]}),(0,i.jsx)(v.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Активные"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-green-600",children:g.active_users})]}),(0,i.jsx)(w.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Заблокированные"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-red-600",children:g.blocked_users})]}),(0,i.jsx)(y.Z,{className:"h-8 w-8 text-red-500"})]})})}),(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Новые за месяц"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:g.new_users_this_month})]}),(0,i.jsx)(k.Z,{className:"h-8 w-8 text-orange-500"})]})})})]}),(0,i.jsx)(en,{filters:e,onFiltersChange:e=>{s(e)},onSearch:()=>{l()},onReset:()=>{s({email:"",role:"all",status:"all"})}}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Пользователи"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Управление пользователями системы"})]}),(0,i.jsxs)(d.z,{onClick:()=>{l()},variant:"outline",disabled:t,children:[(0,i.jsx)(C.Z,{className:"h-4 w-4 mr-2 ".concat(t?"animate-spin":"")}),"Обновить"]})]}),t?(0,i.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,i.jsx)(f.Z,{className:"h-8 w-8 animate-spin text-orange-500"}),(0,i.jsx)("span",{className:"ml-2 text-gray-600",children:"Загрузка пользователей..."})]}):0===a.length?(0,i.jsx)(o.Zb,{children:(0,i.jsxs)(o.aY,{className:"p-12 text-center",children:[(0,i.jsx)(v.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Пользователи не найдены"}),(0,i.jsx)("p",{className:"text-gray-600",children:e.search||"all"!==e.role||"all"!==e.status?"Попробуйте изменить фильтры поиска":"В системе пока нет зарегистрированных пользователей"})]})}):(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>(0,i.jsx)(es,{user:e,onRoleChange:j,onStatusChange:p,onDelete:b},e.id))})]})}var eg=a(8997),ej=a(525),ep=a(9334),eN=a(8728);function eb(){let[e,s]=(0,c.useState)(null),[a,t]=(0,c.useState)(!0),[r,l]=(0,c.useState)(null),[n,m]=(0,c.useState)(null),x=async()=>{try{t(!0),l(null);let e=await fetch("/api/admin/database-stats"),a=await e.json();if(!e.ok)throw Error(a.error||"Ошибка загрузки статистики");s(a),m(new Date)}catch(e){console.error("Error fetching database stats:",e),l(e.message)}finally{t(!1)}};if((0,c.useEffect)(()=>{x()},[]),a)return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Статистика базы данных"}),(0,i.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-orange-500"})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(8)].map((e,s)=>(0,i.jsx)(o.Zb,{className:"animate-pulse",children:(0,i.jsxs)(o.aY,{className:"p-6",children:[(0,i.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,i.jsx)("div",{className:"h-8 bg-gray-200 rounded"})]})},s))})]});if(r)return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Статистика базы данных"}),(0,i.jsxs)(d.z,{onClick:x,variant:"outline",size:"sm",children:[(0,i.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Обновить"]})]}),(0,i.jsx)(o.Zb,{className:"border-red-200 bg-red-50",children:(0,i.jsxs)(o.aY,{className:"p-6 text-center",children:[(0,i.jsx)("div",{className:"text-red-600 mb-2",children:"⚠️ Ошибка загрузки статистики"}),(0,i.jsx)("p",{className:"text-red-500 text-sm mb-4",children:r}),(0,i.jsx)(d.z,{onClick:x,variant:"outline",size:"sm",children:"Попробовать снова"})]})})]});if(!e)return(0,i.jsx)("div",{className:"text-center py-8",children:(0,i.jsx)("p",{className:"text-gray-500",children:"Нет данных для отображения"})});let u=e.activePets>0?Math.round(e.foundPets/e.activePets*100):0;return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Статистика базы данных"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[n&&(0,i.jsxs)("span",{className:"text-sm text-gray-500",children:["Обновлено: ",n.toLocaleTimeString()]}),(0,i.jsxs)(d.z,{onClick:x,variant:"outline",size:"sm",children:[(0,i.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Обновить"]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,i.jsx)(o.Zb,{className:"hover:shadow-md transition-shadow",children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Всего пользователей"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:e.users})]}),(0,i.jsx)(v.Z,{className:"h-8 w-8 text-blue-500"})]})})}),(0,i.jsx)(o.Zb,{className:"hover:shadow-md transition-shadow",children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Всего объявлений"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.pets})]}),(0,i.jsx)(eg.Z,{className:"h-8 w-8 text-green-500"})]})})}),(0,i.jsx)(o.Zb,{className:"hover:shadow-md transition-shadow",children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Активных объявлений"}),(0,i.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:e.activePets})]}),(0,i.jsx)(er.Z,{className:"h-8 w-8 text-orange-500"})]})})}),(0,i.jsx)(o.Zb,{className:"hover:shadow-md transition-shadow",children:(0,i.jsx)(o.aY,{className:"p-6",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Успешность поиска"}),(0,i.jsxs)("p",{className:"text-2xl font-bold text-purple-600",children:[u,"%"]})]}),(0,i.jsx)(ej.Z,{className:"h-8 w-8 text-purple-500"})]})})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{className:"pb-3",children:(0,i.jsxs)(o.ll,{className:"text-lg flex items-center gap-2",children:[(0,i.jsx)(er.Z,{className:"h-5 w-5 text-red-500"}),"Потерянные питомцы"]})}),(0,i.jsxs)(o.aY,{children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-red-600 mb-2",children:e.lostPets}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Активных объявлений о пропаже"}),(0,i.jsx)(_.C,{variant:"destructive",className:"mt-2",children:"Требуют внимания"})]})]}),(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{className:"pb-3",children:(0,i.jsxs)(o.ll,{className:"text-lg flex items-center gap-2",children:[(0,i.jsx)(j.Z,{className:"h-5 w-5 text-green-500"}),"Найденные питомцы"]})}),(0,i.jsxs)(o.aY,{children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-2",children:e.foundPets}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Питомцев, ожидающих хозяев"}),(0,i.jsx)(_.C,{variant:"default",className:"mt-2 bg-green-500",children:"Готовы к воссоединению"})]})]}),(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{className:"pb-3",children:(0,i.jsxs)(o.ll,{className:"text-lg flex items-center gap-2",children:[(0,i.jsx)(ep.Z,{className:"h-5 w-5 text-gray-500"}),"Архивные объявления"]})}),(0,i.jsxs)(o.aY,{children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-gray-600 mb-2",children:e.archivedPets}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Завершенных случаев"}),(0,i.jsx)(_.C,{variant:"secondary",className:"mt-2",children:"Успешно решены"})]})]})]}),(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{children:(0,i.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,i.jsx)(eN.Z,{className:"h-5 w-5 text-orange-500"}),"Системная информация"]})}),(0,i.jsx)(o.aY,{children:(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Настройки приложения"}),(0,i.jsxs)("p",{className:"text-lg font-semibold",children:[e.appSettings," записей"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"База данных"}),(0,i.jsx)("p",{className:"text-lg font-semibold",children:"Supabase"})]})]})})]})]})}let ev=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("div",{className:"relative w-full overflow-auto",children:(0,i.jsx)("table",{ref:s,className:(0,U.cn)("w-full caption-bottom text-sm",a),...t})})});ev.displayName="Table";let ew=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("thead",{ref:s,className:(0,U.cn)("[&_tr]:border-b",a),...t})});ew.displayName="TableHeader";let ey=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("tbody",{ref:s,className:(0,U.cn)("[&_tr:last-child]:border-0",a),...t})});ey.displayName="TableBody",c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("tfoot",{ref:s,className:(0,U.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t})}).displayName="TableFooter";let ek=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("tr",{ref:s,className:(0,U.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t})});ek.displayName="TableRow";let eC=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("th",{ref:s,className:(0,U.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t})});eC.displayName="TableHead";let e_=c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("td",{ref:s,className:(0,U.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t})});e_.displayName="TableCell",c.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,i.jsx)("caption",{ref:s,className:(0,U.cn)("mt-4 text-sm text-muted-foreground",a),...t})}).displayName="TableCaption";var eS=a(91),eZ=a(2208),ez=a(5868);function eE(){let[e,s]=(0,c.useState)("pets"),[a,t]=(0,c.useState)([]),[r,l]=(0,c.useState)([]),[n,x]=(0,c.useState)([]),[h,f]=(0,c.useState)(!1),[g,j]=(0,c.useState)(null),[p,N]=(0,c.useState)(""),[b,v]=(0,c.useState)("all"),[w,y]=(0,c.useState)("created_at"),[k,S]=(0,c.useState)("desc"),Z=(0,m.useRouter)(),z=async e=>{try{f(!0),j(null);let s=await fetch("/api/admin/database-tables?table=".concat(e)),a=await s.json();if(!s.ok)throw Error(a.error||"Ошибка загрузки данных");switch(e){case"pets":t(a.data||[]);break;case"users":l(a.data||[]);break;case"settings":x(a.data||[])}}catch(s){console.error("Error fetching ".concat(e,":"),s),j(s.message)}finally{f(!1)}},E=async(s,a)=>{if(confirm("Вы уверены, что хотите удалить эту запись?"))try{let t=await fetch("/api/admin/database-tables",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({table:s,id:a})});if(!t.ok){let e=await t.json();throw Error(e.error||"Ошибка удаления")}z(e),alert("Запись успешно удалена!")}catch(e){console.error("Error deleting record:",e),alert("Ошибка удаления: ".concat(e.message))}};(0,c.useEffect)(()=>{z(e)},[e]);let R=e=>new Date(e).toLocaleString("ru-RU"),O=e=>{switch(e){case"active":return(0,i.jsx)(_.C,{className:"bg-green-500",children:"Активно"});case"archived":return(0,i.jsx)(_.C,{className:"bg-gray-500",children:"Архив"});case"found":return(0,i.jsx)(_.C,{className:"bg-blue-500",children:"Найден"});default:return(0,i.jsx)(_.C,{variant:"secondary",children:e})}},I=e=>{switch(e){case"lost":return(0,i.jsx)(_.C,{className:"bg-red-500",children:"Потерялся"});case"found":return(0,i.jsx)(_.C,{className:"bg-green-500",children:"Найден"});default:return(0,i.jsx)(_.C,{variant:"secondary",children:e})}},A=a.filter(e=>{let s=e.name.toLowerCase().includes(p.toLowerCase())||e.breed.toLowerCase().includes(p.toLowerCase())||e.location.toLowerCase().includes(p.toLowerCase())||e.contact_name.toLowerCase().includes(p.toLowerCase())||e.user_email&&e.user_email.toLowerCase().includes(p.toLowerCase()),a="all"===b||"anonymous"===b&&!e.user_id||"registered"===b&&e.user_id||"all"!==b&&"anonymous"!==b&&"registered"!==b&&e.user_id===b;return s&&a}).sort((e,s)=>{let a,t;switch(w){case"name":a=e.name.toLowerCase(),t=s.name.toLowerCase();break;case"user_email":a=e.user_email||"",t=s.user_email||"";break;default:a=new Date(e.created_at).getTime(),t=new Date(s.created_at).getTime()}return"asc"===k?a<t?-1:a>t?1:0:a>t?-1:a<t?1:0}),D=r.filter(e=>e.email.toLowerCase().includes(p.toLowerCase()));return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Управление базой данных"}),(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsxs)(d.z,{onClick:()=>z(e),variant:"outline",size:"sm",children:[(0,i.jsx)(C.Z,{className:"h-4 w-4 mr-2"}),"Обновить"]})})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)(d.z,{variant:"pets"===e?"default":"outline",onClick:()=>s("pets"),className:"pets"===e?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(eS.Z,{className:"h-4 w-4 mr-2"}),"Объявления (",a.length,")"]}),(0,i.jsxs)(d.z,{variant:"users"===e?"default":"outline",onClick:()=>s("users"),className:"users"===e?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(eS.Z,{className:"h-4 w-4 mr-2"}),"Пользователи (",r.length,")"]}),(0,i.jsxs)(d.z,{variant:"settings"===e?"default":"outline",onClick:()=>s("settings"),className:"settings"===e?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(eS.Z,{className:"h-4 w-4 mr-2"}),"Настройки (",n.length,")"]})]}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(er.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsx)(u.I,{placeholder:"Поиск в ".concat("pets"===e?"объявлениях":"users"===e?"пользователях":"настройках","..."),value:p,onChange:e=>N(e.target.value),className:"max-w-sm"})]}),"pets"===e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(et.Z,{className:"h-4 w-4 text-gray-500"}),(0,i.jsxs)("select",{value:b,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,i.jsx)("option",{value:"all",children:"Все пользователи"}),(0,i.jsx)("option",{value:"registered",children:"Зарегистрированные"}),(0,i.jsx)("option",{value:"anonymous",children:"Анонимные"}),r.map(e=>(0,i.jsx)("option",{value:e.id,children:e.email},e.id))]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-sm text-gray-500",children:"Сортировка:"}),(0,i.jsxs)("select",{value:w,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[(0,i.jsx)("option",{value:"created_at",children:"По дате"}),(0,i.jsx)("option",{value:"name",children:"По имени"}),(0,i.jsx)("option",{value:"user_email",children:"По пользователю"})]}),(0,i.jsx)(d.z,{size:"sm",variant:"outline",onClick:()=>S("asc"===k?"desc":"asc"),children:"asc"===k?"↑":"↓"})]})]})]}),g&&(0,i.jsx)(o.Zb,{className:"border-red-200 bg-red-50",children:(0,i.jsxs)(o.aY,{className:"p-4 text-center",children:[(0,i.jsx)("div",{className:"text-red-600 mb-2",children:"⚠️ Ошибка загрузки данных"}),(0,i.jsx)("p",{className:"text-red-500 text-sm",children:g})]})}),h?(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Загрузка данных..."})]}):(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{children:(0,i.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,i.jsx)(eS.Z,{className:"h-5 w-5 text-orange-500"}),"pets"===e&&"Объявления (".concat(A.length,")"),"users"===e&&"Пользователи (".concat(D.length,")"),"settings"===e&&"Настройки (".concat(n.length,")")]})}),(0,i.jsxs)(o.aY,{children:["pets"===e&&(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(ev,{children:[(0,i.jsx)(ew,{children:(0,i.jsxs)(ek,{children:[(0,i.jsx)(eC,{children:"ID"}),(0,i.jsx)(eC,{children:"Тип"}),(0,i.jsx)(eC,{children:"Имя"}),(0,i.jsx)(eC,{children:"Порода"}),(0,i.jsx)(eC,{children:"Местоположение"}),(0,i.jsx)(eC,{children:"Пользователь"}),(0,i.jsx)(eC,{children:"Статус"}),(0,i.jsx)(eC,{children:"Создано"}),(0,i.jsx)(eC,{children:"Действия"})]})}),(0,i.jsx)(ey,{children:A.map(e=>(0,i.jsxs)(ek,{children:[(0,i.jsxs)(e_,{className:"font-mono text-xs",children:[e.id.slice(0,8),"..."]}),(0,i.jsx)(e_,{children:I(e.type)}),(0,i.jsx)(e_,{className:"font-medium",children:e.name}),(0,i.jsx)(e_,{children:e.breed}),(0,i.jsx)(e_,{children:e.location}),(0,i.jsx)(e_,{children:e.user_id?(0,i.jsxs)("div",{className:"text-sm",children:[(0,i.jsxs)("div",{className:"font-mono text-xs text-gray-500",children:[e.user_id.slice(0,8),"..."]}),(0,i.jsx)("div",{className:"text-gray-600",children:e.user_email||"Неизвестно"})]}):(0,i.jsx)(_.C,{variant:"secondary",children:"Анонимно"})}),(0,i.jsx)(e_,{children:O(e.status)}),(0,i.jsx)(e_,{className:"text-sm",children:R(e.created_at)}),(0,i.jsx)(e_,{children:(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)(d.z,{size:"sm",variant:"outline",onClick:()=>Z.push("/pet/".concat(e.id)),children:(0,i.jsx)(eZ.Z,{className:"h-3 w-3"})}),(0,i.jsx)(d.z,{size:"sm",variant:"outline",onClick:()=>Z.push("/add?id=".concat(e.id,"&from=admin")),children:(0,i.jsx)(ez.Z,{className:"h-3 w-3"})}),(0,i.jsx)(d.z,{size:"sm",variant:"outline",onClick:()=>E("pets",e.id),className:"text-red-600 hover:text-red-700",children:(0,i.jsx)(T.Z,{className:"h-3 w-3"})})]})})]},e.id))})]})}),"users"===e&&(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(ev,{children:[(0,i.jsx)(ew,{children:(0,i.jsxs)(ek,{children:[(0,i.jsx)(eC,{children:"ID"}),(0,i.jsx)(eC,{children:"Email"}),(0,i.jsx)(eC,{children:"Подтвержден"}),(0,i.jsx)(eC,{children:"Создан"}),(0,i.jsx)(eC,{children:"Последний вход"}),(0,i.jsx)(eC,{children:"Действия"})]})}),(0,i.jsx)(ey,{children:D.map(e=>(0,i.jsxs)(ek,{children:[(0,i.jsxs)(e_,{className:"font-mono text-xs",children:[e.id.slice(0,8),"..."]}),(0,i.jsx)(e_,{className:"font-medium",children:e.email}),(0,i.jsx)(e_,{children:e.email_confirmed_at?(0,i.jsx)(_.C,{className:"bg-green-500",children:"Да"}):(0,i.jsx)(_.C,{className:"bg-red-500",children:"Нет"})}),(0,i.jsx)(e_,{className:"text-sm",children:R(e.created_at)}),(0,i.jsx)(e_,{className:"text-sm",children:e.last_sign_in_at?R(e.last_sign_in_at):"Никогда"}),(0,i.jsx)(e_,{children:(0,i.jsx)("div",{className:"flex gap-1",children:(0,i.jsx)(d.z,{size:"sm",variant:"outline",onClick:()=>E("users",e.id),className:"text-red-600 hover:text-red-700",children:(0,i.jsx)(T.Z,{className:"h-3 w-3"})})})})]},e.id))})]})}),"settings"===e&&(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(ev,{children:[(0,i.jsx)(ew,{children:(0,i.jsxs)(ek,{children:[(0,i.jsx)(eC,{children:"ID"}),(0,i.jsx)(eC,{children:"Фоновое изображение"}),(0,i.jsx)(eC,{children:"Затемнение (%)"}),(0,i.jsx)(eC,{children:"Обновлено"}),(0,i.jsx)(eC,{children:"Действия"})]})}),(0,i.jsx)(ey,{children:n.map(e=>(0,i.jsxs)(ek,{children:[(0,i.jsxs)(e_,{className:"font-mono text-xs",children:[e.id.slice(0,8),"..."]}),(0,i.jsx)(e_,{className:"max-w-xs truncate",children:e.background_image_url||"Не задано"}),(0,i.jsxs)(e_,{children:[e.background_darkening_percentage||0,"%"]}),(0,i.jsx)(e_,{className:"text-sm",children:R(e.updated_at)}),(0,i.jsx)(e_,{children:(0,i.jsx)("div",{className:"flex gap-1",children:(0,i.jsx)(d.z,{size:"sm",variant:"outline",onClick:()=>Z.push("/admin?tab=settings"),children:(0,i.jsx)(ez.Z,{className:"h-3 w-3"})})})})]},e.id))})]})})]})]})]})}var eR=a(4938),eO=a(2029),eT=a(2718);function eI(){let{user:e,loading:s,isAuthenticated:a}=(0,x.B)(),[t,r]=(0,c.useState)("settings"),l=(0,m.useRouter)(),n=(0,m.useSearchParams)();(0,c.useEffect)(()=>{if(s)return;if(!a||!e){l.push("/auth");return}if("agentgl007@gmail.com"!==e.email){l.push("/");return}let t=n.get("tab");t&&["settings","users","database","tables","background"].includes(t)&&r(t)},[e,s,a,l,n]);let u=(null==e?void 0:e.email)==="agentgl007@gmail.com";return s?(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-orange-50 flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Загрузка админ панели..."})]})}):u?(0,i.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-orange-50",children:[(0,i.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,i.jsxs)("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)(eN.Z,{className:"h-8 w-8 text-orange-500"}),(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Админ панель"})]}),(0,i.jsx)("div",{className:"flex items-center gap-4",children:(0,i.jsxs)(d.z,{variant:"outline",onClick:()=>l.push("/"),className:"flex items-center gap-2",children:[(0,i.jsx)(eR.Z,{className:"h-4 w-4"}),"На главную"]})})]})}),(0,i.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,i.jsxs)("div",{className:"flex gap-2 mb-8",children:[(0,i.jsxs)(d.z,{variant:"settings"===t?"default":"outline",onClick:()=>r("settings"),className:"settings"===t?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Настройки фона"]}),(0,i.jsxs)(d.z,{variant:"users"===t?"default":"outline",onClick:()=>r("users"),className:"users"===t?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Пользователи"]}),(0,i.jsxs)(d.z,{variant:"database"===t?"default":"outline",onClick:()=>r("database"),className:"database"===t?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(eS.Z,{className:"h-4 w-4 mr-2"}),"Статистика БД"]}),(0,i.jsxs)(d.z,{variant:"tables"===t?"default":"outline",onClick:()=>r("tables"),className:"tables"===t?"bg-orange-500 hover:bg-orange-600":"",children:[(0,i.jsx)(eO.Z,{className:"h-4 w-4 mr-2"}),"Таблицы БД"]}),(0,i.jsxs)(d.z,{variant:"outline",onClick:()=>l.push("/admin/chats"),className:"flex items-center gap-2",children:[(0,i.jsx)(eT.Z,{className:"h-4 w-4"}),"Управление чатами"]})]}),"settings"===t&&(0,i.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,i.jsxs)(o.Zb,{children:[(0,i.jsx)(o.Ol,{children:(0,i.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,i.jsx)(g.Z,{className:"h-5 w-5 text-orange-500"}),"Настройки приложения"]})}),(0,i.jsx)(o.aY,{children:(0,i.jsx)(b,{})})]})}),"users"===t&&(0,i.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,i.jsx)(ef,{})}),"database"===t&&(0,i.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,i.jsx)(eb,{})}),"tables"===t&&(0,i.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,i.jsx)(eE,{})})]})]}):(0,i.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-orange-50 flex items-center justify-center",children:(0,i.jsx)(o.Zb,{className:"w-full max-w-md mx-auto",children:(0,i.jsxs)(o.aY,{className:"p-8 text-center",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Доступ запрещен"}),(0,i.jsx)("p",{className:"text-gray-600 mb-6",children:"У вас нет прав для доступа к админ панели."}),(0,i.jsx)(d.z,{onClick:()=>l.push("/"),className:"bg-orange-500 hover:bg-orange-600",children:"Вернуться на главную"})]})})})}},5974:function(e,s,a){"use strict";a.d(s,{C:function(){return i}});var t=a(7437);a(2265);var r=a(535),l=a(4508);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,l.cn)(n({variant:a}),s),...r})}},2869:function(e,s,a){"use strict";a.d(s,{d:function(){return c},z:function(){return d}});var t=a(7437),r=a(2265),l=a(7053),n=a(535),i=a(4508);let c=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:a,variant:r,size:n,asChild:d=!1,...o}=e,m=d?l.g7:"button";return(0,t.jsx)(m,{className:(0,i.cn)(c({variant:r,size:n,className:a})),ref:s,...o})});d.displayName="Button"},6070:function(e,s,a){"use strict";a.d(s,{Ol:function(){return i},Zb:function(){return n},aY:function(){return d},ll:function(){return c}});var t=a(7437),r=a(2265),l=a(4508);let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});c.displayName="CardTitle",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})}).displayName="CardDescription";let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",a),...r})});d.displayName="CardContent",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},5186:function(e,s,a){"use strict";a.d(s,{I:function(){return n}});var t=a(7437),r=a(2265),l=a(4508);let n=r.forwardRef((e,s)=>{let{className:a,type:r,...n}=e;return(0,t.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...n})});n.displayName="Input"},6815:function(e,s,a){"use strict";a.d(s,{_:function(){return d}});var t=a(7437),r=a(2265),l=a(6394),n=a(535),i=a(4508);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.f,{ref:s,className:(0,i.cn)(c(),a),...r})});d.displayName=l.f.displayName},3647:function(e,s,a){"use strict";a.d(s,{Bw:function(){return f},Ph:function(){return o},Ql:function(){return g},i4:function(){return x},ki:function(){return m}});var t=a(7437),r=a(2265),l=a(5377),n=a(875),i=a(2135),c=a(401),d=a(4508);let o=l.fC;l.ZA;let m=l.B4,x=r.forwardRef((e,s)=>{let{className:a,children:r,...i}=e;return(0,t.jsxs)(l.xz,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[r,(0,t.jsx)(l.JO,{asChild:!0,children:(0,t.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=l.xz.displayName;let u=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});u.displayName=l.u_.displayName;let h=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=l.$G.displayName;let f=r.forwardRef((e,s)=>{let{className:a,children:r,position:n="popper",...i}=e;return(0,t.jsx)(l.h_,{children:(0,t.jsxs)(l.VY,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...i,children:[(0,t.jsx)(u,{}),(0,t.jsx)(l.l_,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(h,{})]})})});f.displayName=l.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=l.__.displayName;let g=r.forwardRef((e,s)=>{let{className:a,children:r,...n}=e;return(0,t.jsxs)(l.ck,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.wU,{children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(l.eT,{children:r})]})});g.displayName=l.ck.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=l.Z0.displayName},8190:function(e,s,a){"use strict";a.d(s,{B:function(){return l}});var t=a(2265),r=a(2141);function l(){let[e,s]=(0,t.useState)(null),[a,l]=(0,t.useState)(null),[n,i]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{if((async()=>{if(!r.O){console.warn("Supabase client not initialized"),i(!1);return}try{let{data:{session:e},error:a}=await r.O.auth.getSession();a?console.error("Error getting session:",a):(s(e),l((null==e?void 0:e.user)||null))}catch(e){console.error("Failed to fetch session:",e)}i(!1)})(),r.O){let{data:{subscription:e}}=r.O.auth.onAuthStateChange(async(e,a)=>{console.log("Auth state changed:",e,a),s(a),l((null==a?void 0:a.user)||null),i(!1)});return()=>{null==e||e.unsubscribe()}}},[]),{session:e,user:a,loading:n,isAuthenticated:!!a}}},2141:function(e,s,a){"use strict";a.d(s,{O:function(){return l},e:function(){return n}});var t=a(6580);let r="https://erjszhoaxapnkluezwpy.supabase.co",l=r.includes("placeholder")?null:(0,t.eI)(r,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVyanN6aG9heGFwbmtsdWV6d3B5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzOTg2MjUsImV4cCI6MjA3MTk3NDYyNX0.IvgGGZDzq-7YJZAGWBeqcyR5BL1fc6zBrhMa1qiE5Rs",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"Content-Type":"application/json; charset=utf-8"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),n=l||{from:()=>({select:()=>({eq:()=>({order:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),single:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})}),insert:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})}),update:()=>({eq:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})})}),storage:{from:()=>({upload:()=>Promise.resolve({data:null,error:Error("Supabase Storage not configured")}),getPublicUrl:()=>({data:{publicUrl:"/placeholder.svg"}})})}}},4508:function(e,s,a){"use strict";a.d(s,{cn:function(){return l}});var t=a(1994),r=a(3335);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.m6)((0,t.W)(s))}a(257)}},function(e){e.O(0,[580,432,635,160,456,971,117,744],function(){return e(e.s=4379)}),_N_E=e.O()}]);