(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{2178:function(e,r,t){Promise.resolve().then(t.bind(t,1457))},1457:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return i}});var a=t(7437),s=t(2265),l=t(9376),o=t(7648),n=t(2141);function i(){let[e,r]=(0,s.useState)(!0),[t,i]=(0,s.useState)(""),[c,u]=(0,s.useState)(!1);(0,l.useRouter)();let d=(0,l.useSearchParams)();return((0,s.useEffect)(()=>{(async()=>{let e=d.get("access_token"),t=d.get("refresh_token"),a=d.get("type"),s=d.get("token");if(console.log("URL parameters:",{access_token:e,refresh_token:t,type:a,token:s,email:d.get("email")}),console.log("Full URL:",window.location.href),console.log("Search params:",window.location.search),!n.O){i("Система подтверждения недоступна"),r(!1);return}try{if(e&&t&&"signup"===a){let{error:r}=await n.O.auth.setSession({access_token:e,refresh_token:t});r?(console.error("Error setting session:",r),i("Ошибка при подтверждении email: "+r.message)):u(!0)}else if(s){let{data:{user:e},error:r}=await n.O.auth.getUser();r?(console.error("Error getting user:",r),i("Ошибка при подтверждении email: "+r.message)):(null==e?void 0:e.email_confirmed_at)?u(!0):setTimeout(async()=>{let{data:{user:e}}=await n.O.auth.getUser();(null==e?void 0:e.email_confirmed_at)?u(!0):i("Токен подтверждения недействителен или истек")},2e3)}else{var l;let{data:{session:e},error:r}=await n.O.auth.getSession();r?(console.error("Error getting session:",r),i("Неверная ссылка для подтверждения email")):(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.email_confirmed_at)?u(!0):i("Неверная ссылка для подтверждения email")}}catch(e){console.error("Error in email verification:",e),i("Ошибка при подтверждении email: "+e.message)}r(!1)})()},[d]),e)?(0,a.jsx)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-gradient-to-br from-yellow-50 to-orange-100 rounded-lg shadow-lg border-2 border-yellow-200",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-yellow-600 text-4xl mb-4",children:"⏳"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-yellow-800",children:"Подтверждение email"}),(0,a.jsx)("p",{className:"text-yellow-600",children:"Проверяем вашу ссылку через Supabase..."})]})}):c?(0,a.jsx)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-green-600 text-4xl mb-4",children:"✓"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-green-600",children:"Email подтвержден!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Ваш email успешно подтвержден. Теперь вы можете войти в систему."}),(0,a.jsx)(o.default,{href:"/auth",className:"block w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded text-center",children:"Войти в систему"})]})}):(0,a.jsx)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-600 text-4xl mb-4",children:"⚠"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"Ошибка подтверждения"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:t||"Ссылка для подтверждения email недействительна или истекла."}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.default,{href:"/auth",className:"block w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded text-center",children:"Вернуться к входу"}),(0,a.jsx)(o.default,{href:"/register",className:"block w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded text-center",children:"Зарегистрироваться заново"})]})]})})}},2141:function(e,r,t){"use strict";t.d(r,{O:function(){return l},e:function(){return o}});var a=t(6580);let s="https://erjszhoaxapnkluezwpy.supabase.co",l=s.includes("placeholder")?null:(0,a.eI)(s,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVyanN6aG9heGFwbmtsdWV6d3B5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzOTg2MjUsImV4cCI6MjA3MTk3NDYyNX0.IvgGGZDzq-7YJZAGWBeqcyR5BL1fc6zBrhMa1qiE5Rs",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"Content-Type":"application/json; charset=utf-8"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),o=l||{from:()=>({select:()=>({eq:()=>({order:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),single:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})}),insert:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})}),update:()=>({eq:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})})}),storage:{from:()=>({upload:()=>Promise.resolve({data:null,error:Error("Supabase Storage not configured")}),getPublicUrl:()=>({data:{publicUrl:"/placeholder.svg"}})})}}},7648:function(e,r,t){"use strict";t.d(r,{default:function(){return s.a}});var a=t(2972),s=t.n(a)},9376:function(e,r,t){"use strict";var a=t(5475);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[580,972,971,117,744],function(){return e(e.s=2178)}),_N_E=e.O()}]);