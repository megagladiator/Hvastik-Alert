(()=>{var e={};e.id=5230,e.ids=[5230],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},48152:(e,r,s)=>{"use strict";s.r(r),s.d(r,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h});var t={};s.r(t),s.d(t,{POST:()=>c});var o=s(73278),a=s(45002),u=s(54877),i=s(71309),n=s(1482),l=s(66572),p=s(22221);async function c(e){try{let{email:r}=await e.json();if(!r)return i.NextResponse.json({error:"Email is required"},{status:400});if(!n.O)return i.NextResponse.json({error:"Supabase not initialized"},{status:500});if(l.RU){let{data:e,error:s}=await l.RU.auth.admin.getUserByEmail(r);if(s||!e.user)return i.NextResponse.json({error:"Пользователь с таким email не зарегистрирован. Пожалуйста, пройдите регистрацию для доступа к личному кабинету сайта."},{status:404})}let s=(0,p.N6)("/auth/reset-password",e),{error:t}=await n.O.auth.resetPasswordForEmail(r,{redirectTo:s});if(console.log("Password reset request for:",r),console.log("Redirect URL:",s),t){if(console.error("Error sending password reset email:",t),t.message.includes("User not found")||t.message.includes("not found"))return i.NextResponse.json({error:"Пользователь с таким email не зарегистрирован. Пожалуйста, пройдите регистрацию для доступа к личному кабинету сайта."},{status:404});if(t.message.includes("Invalid email"))return i.NextResponse.json({error:"Неверный формат email"},{status:400});if(t.message.includes("Too many requests")||t.message.includes("rate limit"))return i.NextResponse.json({error:"Слишком много запросов. Попробуйте позже"},{status:429});return i.NextResponse.json({error:"Произошла ошибка при отправке письма для сброса пароля",details:t.message},{status:500})}return i.NextResponse.json({message:"Ссылка для сброса пароля отправлена на email",success:!0})}catch(e){return console.error("Error in forgot password API:",e),i.NextResponse.json({error:"Произошла ошибка при отправке письма для сброса пароля",details:e.message},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api-backup/auth/forgot-password/route",pathname:"/api-backup/auth/forgot-password",filename:"route",bundlePath:"app/api-backup/auth/forgot-password/route"},resolvedPagePath:"D:\\DATA\\Hvastik-Alert\\app\\api-backup\\auth\\forgot-password\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:f}=d,g="/api-backup/auth/forgot-password/route";function x(){return(0,u.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},66572:(e,r,s)=>{"use strict";s.d(r,{RU:()=>u,c2:()=>i});var t=s(52418);let o="https://erjszhoaxapnkluezwpy.supabase.co",a=process.env.SUPABASE_SERVICE_ROLE_KEY,u=o&&a?(0,t.eI)(o,a,{auth:{autoRefreshToken:!1,persistSession:!1}}):null,i=u||{from:()=>({select:()=>({eq:()=>({order:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),single:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})}),insert:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),single:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})}),update:()=>({eq:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})}),delete:()=>({eq:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})}),auth:{admin:{listUsers:()=>Promise.resolve({data:{users:[]},error:Error("Supabase not configured")}),getUserByEmail:()=>Promise.resolve({data:{user:null},error:Error("Supabase not configured")}),deleteUser:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),updateUserById:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})}}}},1482:(e,r,s)=>{"use strict";s.d(r,{O:()=>a});var t=s(52418);let o="https://erjszhoaxapnkluezwpy.supabase.co",a=o.includes("placeholder")?null:(0,t.eI)(o,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVyanN6aG9heGFwbmtsdWV6d3B5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzOTg2MjUsImV4cCI6MjA3MTk3NDYyNX0.IvgGGZDzq-7YJZAGWBeqcyR5BL1fc6zBrhMa1qiE5Rs",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"Content-Type":"application/json; charset=utf-8"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}})},22221:(e,r,s)=>{"use strict";function t(e){if(e){let r=e.headers.get("origin")||e.headers.get("host"),s=e.headers.get("x-forwarded-proto")||"http";return`${s}://${r}`}return process.env.NEXTAUTH_URL||"http://localhost:3000"}function o(e,r){let s=t(r);return`${s}${e}`}function a(e){let r=t(e);return[`${r}/auth/verify-email`,`${r}/auth/reset-password`,`${r}/auth/callback`,`${r}/auth/error`]}s.d(r,{N6:()=>o,up:()=>a})}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[7787,4833,2418],()=>s(48152));module.exports=t})();