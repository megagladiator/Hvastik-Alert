(()=>{var e={};e.id=5737,e.ids=[5737],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},71199:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>g,originalPathname:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>d}),s(24363),s(13973),s(90996);var r=s(30170),i=s(45002),a=s(83876),n=s.n(a),l=s(66299),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["test-settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,24363)),"D:\\DATA\\Hvastik-Alert\\app\\test-settings\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,13973)),"D:\\DATA\\Hvastik-Alert\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,68199)),"D:\\DATA\\Hvastik-Alert\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,90996,23)),"next/dist/client/components/not-found-error"]}],u=["D:\\DATA\\Hvastik-Alert\\app\\test-settings\\page.tsx"],c="/test-settings/page",g={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/test-settings/page",pathname:"/test-settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},42397:(e,t,s)=>{Promise.resolve().then(s.bind(s,99858))},99858:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(97247),i=s(28964),a=s(92448);function n(){let[e,t]=(0,i.useState)(null),[s,n]=(0,i.useState)(!0),[l,o]=(0,i.useState)([]),d="00000000-0000-0000-0000-000000000001",u=e=>{let t=new Date().toLocaleTimeString();o(s=>[...s,`[${t}] ${e}`])},c=async()=>{n(!0),u("Начинаем загрузку настроек...");try{if(!a.O){u("❌ Supabase не настроен");return}u("✅ Supabase настроен, делаем запрос к БД...");let{data:e,error:s}=await a.O.from("app_settings").select("*").eq("id",d).single();if(s){u(`❌ Ошибка при загрузке: ${s.message}`);return}e?(u(`✅ Настройки загружены: ${JSON.stringify(e,null,2)}`),t(e)):u("❌ Настройки не найдены")}catch(e){u(`❌ Неожиданная ошибка: ${e.message}`)}finally{n(!1)}},g=async()=>{u("Начинаем обновление настроек...");try{if(!a.O){u("❌ Supabase не настроен");return}let t=e?.background_image_url,s="/kitten-dog-friendship.jpg"===t?"/adorable-looking-kitten-with-dog.jpg":"/kitten-dog-friendship.jpg";u(`Текущий URL: ${t}`),u(`Обновляем URL изображения на: ${s}`);let r={background_image_url:s,updated_at:new Date().toISOString()};u(`Данные для обновления: ${JSON.stringify(r)}`);let{error:i}=await a.O.from("app_settings").update(r).eq("id",d);if(i){u(`❌ Ошибка при обновлении: ${i.message}`),u(`Детали ошибки: ${JSON.stringify(i)}`);return}u("✅ Настройки обновлены в БД"),await c()}catch(e){u(`❌ Неожиданная ошибка при обновлении: ${e.message}`)}};return(0,r.jsxs)("div",{className:"container mx-auto p-8",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Тест настроек фонового изображения"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Текущие настройки"}),s?r.jsx("p",{children:"Загрузка..."}):e?(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[r.jsx("strong",{children:"ID:"})," ",e.id]}),(0,r.jsxs)("p",{children:[r.jsx("strong",{children:"Background Image URL:"})," ",e.background_image_url||"НЕ УСТАНОВЛЕН"]}),(0,r.jsxs)("p",{children:[r.jsx("strong",{children:"Darkening %:"})," ",e.background_darkening_percentage]}),(0,r.jsxs)("p",{children:[r.jsx("strong",{children:"Updated At:"})," ",e.updated_at]}),e.background_image_url&&(0,r.jsxs)("div",{className:"mt-4",children:[r.jsx("p",{children:r.jsx("strong",{children:"Предварительный просмотр:"})}),r.jsx("img",{src:e.background_image_url,alt:"Background preview",className:"w-full h-32 object-cover rounded",onError:t=>{u(`❌ Ошибка загрузки изображения: ${e.background_image_url}`),t.currentTarget.style.display="none"},onLoad:()=>u(`✅ Изображение загружено: ${e.background_image_url}`)})]})]}):r.jsx("p",{children:"Настройки не найдены"})]}),(0,r.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Действия"}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("button",{onClick:c,className:"w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Обновить настройки"}),r.jsx("button",{onClick:g,className:"w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"Установить новое изображение"}),r.jsx("button",{onClick:()=>{u("Отправляем событие settingsUpdated..."),window.dispatchEvent(new CustomEvent("settingsUpdated")),u("✅ Событие отправлено")},className:"w-full bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600",children:"Отправить событие settingsUpdated"}),r.jsx("button",{onClick:async()=>{u("Принудительно обновляем на другое изображение...");let e="/view-cats-dogs-being-friends.jpg";u(`Устанавливаем: ${e}`);let{error:t}=await a.O.from("app_settings").update({background_image_url:e,updated_at:new Date().toISOString()}).eq("id",d);t?u(`❌ Ошибка: ${t.message}`):(u("✅ Принудительное обновление выполнено"),await c())},className:"w-full bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Принудительное обновление"}),r.jsx("button",{onClick:async()=>{u("Тестируем upsert (вставка/обновление)...");let e="/adorable-looking-kitten-with-dog (1).jpg";u(`Upsert с URL: ${e}`);let{error:t}=await a.O.from("app_settings").upsert({id:d,background_image_url:e,background_darkening_percentage:30,updated_at:new Date().toISOString()});t?(u(`❌ Ошибка upsert: ${t.message}`),u(`Детали: ${JSON.stringify(t)}`)):(u("✅ Upsert выполнен"),await c())},className:"w-full bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600",children:"Тест Upsert"})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 bg-black text-green-400 p-4 rounded-lg",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Логи:"}),r.jsx("div",{className:"max-h-64 overflow-y-auto",children:l.map((e,t)=>r.jsx("div",{className:"text-sm font-mono",children:e},t))})]})]})}},24363:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(45347).createProxy)(String.raw`D:\DATA\Hvastik-Alert\app\test-settings\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[7787,1918,1086],()=>s(71199));module.exports=r})();