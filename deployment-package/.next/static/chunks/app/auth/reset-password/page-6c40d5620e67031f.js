(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2048],{9496:function(e,t,s){Promise.resolve().then(s.bind(s,7611))},7611:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437),r=s(2265),n=s(9376),l=s(7648);function d(){let[e,t]=(0,r.useState)(""),[s,d]=(0,r.useState)(""),[u,o]=(0,r.useState)(!1),[c,i]=(0,r.useState)(""),[h,m]=(0,r.useState)(!1),[x,f]=(0,r.useState)(""),[p,g]=(0,r.useState)("");(0,n.useRouter)();let b=(0,n.useSearchParams)();async function w(t){if(t.preventDefault(),i(""),e!==s){i("Пароли не совпадают");return}if(e.length<6){i("Пароль должен содержать минимум 6 символов");return}if(!x||!p){i("Отсутствуют токены для сброса пароля");return}o(!0);try{let t=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:x,refreshToken:p,newPassword:e})}),s=await t.json();if(!t.ok){i(s.error||"Произошла ошибка при сбросе пароля");return}m(!0)}catch(e){i("Произошла ошибка при сбросе пароля")}o(!1)}return((0,r.useEffect)(()=>{let e=b.get("access_token"),t=b.get("refresh_token"),s=b.get("type");e&&t&&"recovery"===s?(f(e),g(t)):i("Неверная ссылка для сброса пароля")},[b]),h)?(0,a.jsx)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-green-600 text-4xl mb-4",children:"✓"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-green-600",children:"Пароль успешно изменен!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Ваш пароль был успешно обновлен. Теперь вы можете войти в систему с новым паролем."}),(0,a.jsx)(l.default,{href:"/auth",className:"block w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded text-center",children:"Войти в систему"})]})}):x&&p?(0,a.jsxs)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Установить новый пароль"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Введите новый пароль для вашего аккаунта"}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsx)("input",{type:"password",placeholder:"Новый пароль",value:e,onChange:e=>t(e.target.value),required:!0,autoComplete:"new-password",name:"password",id:"password",className:"w-full border rounded px-3 py-2",disabled:u,minLength:6}),(0,a.jsx)("input",{type:"password",placeholder:"Подтвердите новый пароль",value:s,onChange:e=>d(e.target.value),required:!0,autoComplete:"new-password",name:"confirm-password",id:"confirm-password",className:"w-full border rounded px-3 py-2",disabled:u,minLength:6}),c&&(0,a.jsxs)("div",{className:"text-red-500 text-sm p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("div",{className:"font-medium mb-1",children:"Ошибка:"}),(0,a.jsx)("div",{children:c})]}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded",disabled:u,children:u?"Обновление...":"Установить новый пароль"}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(l.default,{href:"/auth",className:"text-blue-600 underline",children:"Вернуться к входу"})})]})]}):(0,a.jsx)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-white rounded-lg shadow-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-red-600 text-4xl mb-4",children:"⚠"}),(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-red-600",children:"Неверная ссылка"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Ссылка для сброса пароля недействительна или истекла."}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.default,{href:"/auth/forgot-password",className:"block w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded text-center",children:"Запросить новую ссылку"}),(0,a.jsx)(l.default,{href:"/auth",className:"block w-full bg-gray-500 hover:bg-gray-600 text-white py-2 rounded text-center",children:"Вернуться к входу"})]})]})})}},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=9496)}),_N_E=e.O()}]);