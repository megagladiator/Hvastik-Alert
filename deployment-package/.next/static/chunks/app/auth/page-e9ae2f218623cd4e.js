(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1235],{4822:function(e,s,r){Promise.resolve().then(r.bind(r,1176))},1176:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return o}});var t=r(7437),l=r(2265),i=r(2141),n=r(9376),a=r(7648);function o(){let[e,s]=(0,l.useState)("login"),[r,o]=(0,l.useState)(""),[u,d]=(0,l.useState)(""),[c,m]=(0,l.useState)(""),[h,x]=(0,l.useState)(""),[p,f]=(0,l.useState)(!1),[b,g]=(0,l.useState)(""),j=(0,l.useRef)(null),v=(0,l.useRef)(null),N=(0,l.useRef)(null),w=(0,n.useRouter)();async function S(s){if(s.preventDefault(),x(""),g(""),"register"===e&&u!==c){x("Пароли не совпадают");return}f(!0);try{if("login"===e){if(!i.O){x("Система входа недоступна");return}let{data:e,error:s}=await i.O.auth.signInWithPassword({email:r,password:u});s?(console.error("Ошибка входа:",s),s.message.includes("Email not confirmed")?x("Email не подтвержден. Проверьте почту и подтвердите регистрацию."):s.message.includes("Invalid login credentials")?x("Неверный email или пароль"):s.message.includes("rate limit")||s.message.includes("Too many requests")?x("Слишком много попыток входа. Попробуйте позже"):x("Ошибка при входе")):(g("Вход выполнен!"),setTimeout(()=>{w.push("/cabinet")},500))}else x("Регистрация временно недоступна. Используйте страницу регистрации.")}catch(e){console.error("Ошибка входа:",e),x("Произошла ошибка при входе")}f(!1)}return(0,t.jsxs)("div",{className:"max-w-md w-full mx-auto mt-10 p-6 bg-gradient-to-br from-blue-50 to-indigo-100 rounded-lg shadow-lg border-2 border-blue-200",children:[(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("div",{className:"text-blue-600 text-2xl mb-2",children:"\uD83D\uDD10"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-blue-800",children:"register"===e?"Регистрация":"Вход через Supabase"}),(0,t.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Безопасная аутентификация"})]}),(0,t.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,t.jsx)("input",{type:"email",placeholder:"E-mail",value:r,onChange:e=>o(e.target.value),required:!0,autoComplete:"username",name:"email",id:"email",className:"w-full border-2 border-blue-200 rounded-lg px-4 py-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors",ref:j,disabled:p}),(0,t.jsx)("input",{type:"password",placeholder:"Пароль",value:u,onChange:e=>d(e.target.value),required:!0,autoComplete:"current-password",name:"password",id:"password",className:"w-full border-2 border-blue-200 rounded-lg px-4 py-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors",ref:v,disabled:p}),"register"===e&&(0,t.jsx)("input",{type:"password",placeholder:"Повторите пароль",value:c,onChange:e=>m(e.target.value),required:!0,autoComplete:"new-password",name:"repeat-password",id:"repeat-password",className:"w-full border-2 border-blue-200 rounded-lg px-4 py-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors",ref:N,disabled:p}),h&&(0,t.jsxs)("div",{className:"text-red-500 text-sm p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,t.jsx)("div",{className:"font-medium mb-1",children:"Ошибка:"}),(0,t.jsx)("div",{children:h}),h.includes("Invalid login credentials")&&(0,t.jsxs)("div",{className:"mt-2 text-xs",children:["\uD83D\uDCA1 Попробуйте:",(0,t.jsxs)("ul",{className:"list-disc list-inside mt-1",children:[(0,t.jsx)("li",{children:"Проверить правильность email и пароля"}),(0,t.jsx)("li",{children:"Зарегистрироваться, если аккаунта нет"}),(0,t.jsx)("li",{children:"Сбросить пароль, если забыли"})]})]}),h.includes("Слишком много попыток входа")&&(0,t.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,t.jsx)("p",{children:"Попробуйте снова через час."}),(0,t.jsx)("p",{children:"Это защита от спама."})]}),h.includes("уже существует")&&(0,t.jsxs)("div",{className:"mt-2 text-xs",children:["\uD83D\uDCA1 Попробуйте:",(0,t.jsxs)("ul",{className:"list-disc list-inside mt-1",children:[(0,t.jsx)("li",{children:"Войти в существующий аккаунт"}),(0,t.jsx)("li",{children:"Сбросить пароль, если забыли"}),(0,t.jsx)("li",{children:"Использовать другой email"})]})]}),h.includes("не подтвержден")&&(0,t.jsxs)("div",{className:"mt-2 text-xs",children:["\uD83D\uDCA1 Попробуйте:",(0,t.jsxs)("ul",{className:"list-disc list-inside mt-1",children:[(0,t.jsx)("li",{children:"Проверить почту и подтвердить регистрацию"}),(0,t.jsx)("li",{children:'Проверить папку "Спам"'}),(0,t.jsx)("li",{children:"Запросить повторную отправку письма"}),(0,t.jsx)("li",{children:"Использовать другой email"})]})]})]}),b&&(0,t.jsx)("div",{className:"text-green-600 text-sm p-3 bg-green-50 border border-green-200 rounded-lg",children:b}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl",disabled:p,children:p?"Загрузка...":"register"===e?"Зарегистрироваться":"Войти через Supabase"}),(0,t.jsx)("div",{className:"mt-4 text-center space-y-2",children:"register"===e?(0,t.jsxs)("span",{children:["Уже есть аккаунт? ",(0,t.jsx)("button",{className:"text-blue-600 underline",type:"button",onClick:()=>s("login"),children:"Войти"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:(0,t.jsxs)("span",{children:["Нет аккаунта? ",(0,t.jsx)(a.default,{href:"/register",className:"text-indigo-600 hover:text-indigo-800 underline font-medium",children:"Зарегистрироваться"})]})}),(0,t.jsx)("div",{children:(0,t.jsx)(a.default,{href:"/auth/forgot-password",className:"text-indigo-600 hover:text-indigo-800 underline font-medium",children:"Забыли пароль?"})})]})})]})]})}},2141:function(e,s,r){"use strict";r.d(s,{O:function(){return i},e:function(){return n}});var t=r(6580);let l="https://erjszhoaxapnkluezwpy.supabase.co",i=l.includes("placeholder")?null:(0,t.eI)(l,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVyanN6aG9heGFwbmtsdWV6d3B5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzOTg2MjUsImV4cCI6MjA3MTk3NDYyNX0.IvgGGZDzq-7YJZAGWBeqcyR5BL1fc6zBrhMa1qiE5Rs",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"Content-Type":"application/json; charset=utf-8"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),n=i||{from:()=>({select:()=>({eq:()=>({order:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),single:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})}),insert:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})}),update:()=>({eq:()=>({select:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})})}),storage:{from:()=>({upload:()=>Promise.resolve({data:null,error:Error("Supabase Storage not configured")}),getPublicUrl:()=>({data:{publicUrl:"/placeholder.svg"}})})}}},7648:function(e,s,r){"use strict";r.d(s,{default:function(){return l.a}});var t=r(2972),l=r.n(t)},9376:function(e,s,r){"use strict";var t=r(5475);r.o(t,"useParams")&&r.d(s,{useParams:function(){return t.useParams}}),r.o(t,"usePathname")&&r.d(s,{usePathname:function(){return t.usePathname}}),r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(s,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[6580,2972,2971,2117,1744],function(){return e(e.s=4822)}),_N_E=e.O()}]);