# üîç –ü–†–ê–í–ò–õ–¨–ù–´–ô –î–ò–ê–ì–ù–û–ó: –ü—Ä–æ–±–ª–µ–º–∞ —Å localhost –≤ —Å—Å—ã–ª–∫–∞—Ö

## ‚úÖ –ß–¢–û –ü–†–û–í–ï–†–ï–ù–û –ò –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û

### 1. Supabase Dashboard –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - –ü–†–ê–í–ò–õ–¨–ù–´–ï ‚úÖ
- **Site URL:** `https://hvostikalert.ru` ‚úÖ
- **Redirect URLs:** –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ
- **Email Templates:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω ‚úÖ

### 2. –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - –ü–†–ê–í–ò–õ–¨–ù–´–ô ‚úÖ
- **lib/auth.ts:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è baseUrl ‚úÖ
- **Route Handler:** `/auth/callback/route.ts` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ
- **Supabase –∫–ª–∏–µ–Ω—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç @supabase/ssr –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚úÖ

## üîç –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´ –ü–†–û–ë–õ–ï–ú–´

### 1. NODE_ENV –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ 'production'
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://hvostikalert.ru/debug-env

**–ï—Å–ª–∏ NODE_ENV ‚â† 'production':**
- –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `http://localhost:3000` –≤–º–µ—Å—Ç–æ `https://hvostikalert.ru`
- **–†–µ—à–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `NODE_ENV=production` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### 2. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ Supabase
**–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞:** Supabase –∫–µ—à–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∞—Ç—å 5-10 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫

### 3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Å–±—Ä–æ—Å—É –ø–∞—Ä–æ–ª—è
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `signInWithOtp` –≤–º–µ—Å—Ç–æ `resetPasswordForEmail`
**–†–µ—à–µ–Ω–∏–µ:** –í–µ—Ä–Ω—É–ª–∏—Å—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É `resetPasswordForEmail`

## üõ†Ô∏è –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í v1.2.105

### 1. –í–µ—Ä–Ω—É–ª–∏—Å—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É
```typescript
// –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const result = await supabase.auth.signInWithOtp({
  email: email,
  options: {
    emailRedirectTo: `${baseUrl}/auth/callback`,
    shouldCreateUser: false
  }
})

// –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const result = await supabase.auth.resetPasswordForEmail(email, {
  redirectTo: `${baseUrl}/auth/callback`
})
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- **URL:** https://hvostikalert.ru/debug-env
- **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:** NODE_ENV, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –æ–∂–∏–¥–∞–µ–º—ã–µ vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è

## üß™ –ü–õ–ê–ù –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://hvostikalert.ru/debug-env
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ NODE_ENV = 'production'
3. –ï—Å–ª–∏ –Ω–µ—Ç - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ NODE_ENV=production –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –®–∞–≥ 2: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://hvostikalert.ru/auth/forgot-password
2. –í–≤–µ–¥–∏—Ç–µ email –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç–µ —Å–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∏—Å—å–º–æ - —Å—Å—ã–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –≤–µ—Å—Ç–∏ –Ω–∞ `https://hvostikalert.ru/auth/callback`

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏:
```
üåê Base URL for password reset: https://hvostikalert.ru
üåê NODE_ENV: production
üìß Sending password reset email using resetPasswordForEmail...
```

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

**–ï—Å–ª–∏ NODE_ENV –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ 'production' –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
- –í—Å–µ —Å—Å—ã–ª–∫–∏ –±—É–¥—É—Ç –≤–µ—Å—Ç–∏ –Ω–∞ localhost
- –°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

## üìù –í–µ—Ä—Å–∏—è
**v1.2.105** - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–∏–∞–≥–Ω–æ–∑ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å localhost

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è NODE_ENV –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
- –°—Å—ã–ª–∫–∏ –≤ –ø–∏—Å—å–º–∞—Ö –±—É–¥—É—Ç –≤–µ—Å—Ç–∏ –Ω–∞ `https://hvostikalert.ru/auth/callback`
- –°–∏—Å—Ç–µ–º–∞ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–µ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∏ `ERR_CONNECTION_REFUSED`
